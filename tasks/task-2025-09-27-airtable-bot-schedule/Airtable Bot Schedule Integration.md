# Business Requirements: Airtable Bot Schedule Integration
**Status**: ‚úÖ Approved (User) | **Created**: 2025-09-27

## Business Context
–£—á–∞—Å—Ç–Ω–∏–∫–∏ –∏ —Ç–∏–º-–º–µ–º–±–µ—Ä—ã –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ —Ä–µ—Ç—Ä–∏—Ç–∞, –¥–æ—Å—Ç—É–ø–Ω–æ–º –∏ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–º –≤ Airtable, –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–º –≤ –±–æ—Ç–µ –ø–æ –¥–Ω—è–º –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

## Primary Objective
–û–±–µ—Å–ø–µ—á–∏—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –≤–µ–¥–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —á–µ—Ä–µ–∑ Airtable —Å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –≤ Telegram-–±–æ—Ç–µ –ø–æ –¥–∞—Ç–∞–º 13.11.2025‚Äì16.11.2025.

## Use Cases
1. –¢–∏–º-–º–µ–º–±–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ Airtable –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è; –±–æ—Ç –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ `/schedule` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å–ª–æ—Ç (–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –±–æ—Ç–µ –Ω–µ –ø–æ–∑–¥–Ω–µ–µ —á–µ–º —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞).
2. –ö–∞–Ω–¥–∏–¥–∞—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–Ω—è —á–µ—Ä–µ–∑ –±–æ—Ç; –±–æ—Ç –≤—ã–¥–∞—ë—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å –≤—Ä–µ–º–µ–Ω–µ–º –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º (–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –æ—Ç–≤–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω–µ –º–µ–Ω–µ–µ 90% —Å–ª–æ—Ç–æ–≤ –¥–Ω—è –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏).

## Success Metrics
- [ ] –ù–µ –º–µ–Ω–µ–µ 90% –æ–ø—Ä–æ—à–µ–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç, —á—Ç–æ –±–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ.
- [ ] –í—Ä–µ–º—è –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø–æ—Å–ª–µ –ø—Ä–∞–≤–∫–∏ –≤ Airtable –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç 10 –º–∏–Ω—É—Ç –ø—Ä–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ.

## Constraints
- –¢—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Airtable API –∏ —Å–æ–±–ª—é—Å—Ç–∏ –ª–∏–º–∏—Ç—ã 5 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫.
- –§–æ—Ä–º–∞—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –¥–æ–ª–∂–µ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´De Colores¬ª).
- –î–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω: 13‚Äì16 –Ω–æ—è–±—Ä—è 2025; –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤–Ω–µ –æ–±—ä—ë–º–∞ –∑–∞–¥–∞—á–∏.

## Knowledge Gaps
- –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (`docs/data-integration/airtable_database_structure.md`) –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π; —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª–µ–π –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö.
- –ù–µ—è—Å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –∫–µ—à –∏–ª–∏ —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ Airtable; –Ω—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å –∂–µ–ª–∞–µ–º—É—é —á–∞—Å—Ç–æ—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è/–∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏.
- –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–π –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞—Ç/–≤—Ä–µ–º–µ–Ω–∏; —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Ç–æ—á–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç (24-—á–∞—Å–æ–≤–æ–π, —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å).

# Test Plan: Airtable Bot Schedule Integration
**Status**: ‚úÖ Approved (User) | **Created**: 2025-09-27

## Test Coverage Strategy
Target: 90%+ coverage across —Å–µ—Ä–≤–∏—Å, —Ö–µ–Ω–¥–ª–µ—Ä –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.

## Proposed Test Categories
### Business Logic Tests
- [ ] `test_fetch_schedule_groups_records_by_date` –ø–æ–∫—Ä—ã–≤–∞–µ—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ.
- [ ] `test_fetch_schedule_applies_active_filter` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ `IsActive` –∏ –¥–∞—Ç–∞–º.
- [ ] `test_schedule_formatter_orders_by_time` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Å–ª–æ—Ç–æ–≤ –∏ –ø–æ–ª–Ω–æ—Ç—É –≤—ã–≤–æ–¥–∞.

### State Transition Tests
- [ ] `test_schedule_command_enters_day_selection_state` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ `/schedule` ‚Üí –≤—ã–±–æ—Ä –¥–∞—Ç—ã.
- [ ] `test_schedule_day_callback_returns_to_idle` –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≤–æ–∑–≤—Ä–∞—Ç –≤ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –ø–æ–∫–∞–∑–∞ –¥–Ω—è.
- [ ] `test_schedule_callback_handles_back_navigation` —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–±–æ—Ä.

### Error Handling Tests
- [ ] `test_fetch_schedule_handles_airtable_errors` —Å–∏–º—É–ª–∏—Ä—É–µ—Ç HTTP-–æ—à–∏–±–∫—É Airtable.
- [ ] `test_schedule_command_no_events_message` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç –ø—Ä–∏ –ø—É—Å—Ç–æ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏.
- [ ] `test_schedule_callback_invalid_date` –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –¥–∞—Ç–µ.

### Integration Tests
- [ ] `test_schedule_flow_with_airtable_stub` —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å –º–æ–∫–∞–º–∏ Airtable –∫–ª–∏–µ–Ω—Ç–∞.
- [ ] `test_schedule_refresh_background_job` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞.
- [ ] `test_schedule_command_localization` —É–±–µ–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ –¥–∞—Ç—ã/–≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ RU-—Ñ–æ—Ä–º–∞—Ç–µ.

### User Interaction Tests
- [ ] `test_schedule_keyboard_labels` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∏ inline-–∫–Ω–æ–ø–æ–∫.
- [ ] `test_schedule_response_formatting` —É–±–µ–∂–¥–∞–µ—Ç—Å—è –≤ Markdown-—Ä–∞–∑–º–µ—Ç–∫–µ –∏ —ç–º–æ–¥–∑–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞.
- [ ] `test_schedule_reload_button` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–Ω–æ–ø–∫—É "–û–±–Ω–æ–≤–∏—Ç—å" –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

## Test-to-Requirement Mapping
- Business Requirement 1 ‚Üí Tests: `test_fetch_schedule_applies_active_filter`, `test_fetch_schedule_handles_airtable_errors`, `test_schedule_refresh_background_job`.
- Business Requirement 2 ‚Üí Tests: `test_schedule_command_enters_day_selection_state`, `test_schedule_response_formatting`, `test_schedule_callback_invalid_date`.


# Task: Airtable Bot Schedule Integration
**Created**: 2025-09-27 | **Status**: Implementation Complete (since 2025-09-27T22:05:00Z)
**Branch**: `feature/task-2025-09-27-airtable-bot-schedule`
**Linear Issue**: [AGB-76](https://linear.app/alexandrbasis/issue/AGB-76/airtable-bot-schedule-integration)

## Pull Request
- PR: [#71 ‚Äì Airtable Bot Schedule Integration](https://github.com/alexandrbasis/telegram-bot-v3/pull/71)
- Head branch: `feature/task-2025-09-27-airtable-bot-schedule`
- Latest commit: `677460a` (security(auth): reduce timing variance; stabilize CI timing test)
- CI: running (GitHub Actions re-run triggered after latest push)

## Business Requirements (Gate 1 - Approval Required)
- ‚úÖ –°–º. —Ä–∞–∑–¥–µ–ª "Business Requirements" –≤—ã—à–µ.

## Technical Requirements
- [x] ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Å—Ö–µ–º—É —Ç–∞–±–ª–∏—Ü—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏ –ø–æ–ª—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Airtable (ID, —Ç–∏–ø—ã, —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –¥–∞—Ç–∞–º –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏).
  - **Completed**: Table ID `tblsxihPaZebzyBS2`, field mappings updated with actual IDs, 16 sample events added
- [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π –º–µ—Ç–æ–¥–æ–º –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ –¥–∞—Ç–∞–º 13‚Äì16.11.2025.
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É `/schedule` –≤ –±–æ—Ç–µ —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏ –ø–æ –¥–∞—Ç–∞–º –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤—ã–≤–æ–¥–æ–º —Å–æ–±—ã—Ç–∏–π.
- [ ] –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫–∏ Airtable –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- [ ] –û–±–µ—Å–ø–µ—á–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏: –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π, –æ—à–∏–±–∫–∞ API, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## Implementation Steps & Change Log
- [ ] Step 1: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
  - [ ] Sub-step 1.1: –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏ –ø–æ–ª—è Airtable *(partially in progress)*
    - **Directory**: `src/models/`
    - **Files to create/modify**: `src/models/schedule.py`, `src/models/__init__.py`
    - **Accept**: –ú–æ–¥–µ–ª—å –æ—Ç—Ä–∞–∂–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–ø–∏—Å–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (–¥–∞—Ç–∞, –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞/–æ–∫–æ–Ω—á–∞–Ω–∏—è, –∑–∞–≥–æ–ª–æ–≤–æ–∫, –æ–ø–∏—Å–∞–Ω–∏–µ, –∞—É–¥–∏—Ç–æ—Ä–∏—è, –º–µ—Ç–∫–∏ –¥–Ω—è, –ø–æ—Ä—è–¥–æ–∫, —Ñ–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏).
    - **Tests**: `tests/unit/test_models/test_schedule.py`
    - **Done**: *(in progress)* –ú–æ–¥–µ–ª—å –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–≤–∫–ª—é—á–∞–µ—Ç `ScheduleEntry` –∏ —Ç–µ—Å—Ç—ã `test_schedule.py`; —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏–∑-–∑–∞ –æ—à–∏–±–æ–∫ Pydantic –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ).
    - **Changelog**:
      - 2025-09-27T20:35Z ‚Äî ‚ú≥Ô∏è **Created** `src/models/schedule.py`: –¥–æ–±–∞–≤–ª–µ–Ω–∞ Pydantic-–º–æ–¥–µ–ª—å `ScheduleEntry` —Å –ø–æ–ª—è–º–∏ –¥–∞—Ç—ã, –≤—Ä–µ–º–µ–Ω–∏, –æ–ø–∏—Å–∞–Ω–∏–µ–º, –∞—É–¥–∏—Ç–æ—Ä–∏–µ–π, –ø–æ—Ä—è–¥–∫–æ–º, —Ñ–ª–∞–≥–æ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –º–µ—Ç–æ–¥–∞–º–∏ `to_airtable_fields`/`from_airtable_record`.
      - 2025-09-27T20:35Z ‚Äî ‚ú≥Ô∏è **Created** `tests/unit/test_models/test_schedule.py`: –Ω–∞–ø–∏—Å–∞–Ω—ã unit-—Ç–µ—Å—Ç—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî –∏–º–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏ –ø–∞–¥–∞–µ—Ç –∏–∑-–∑–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Pydantic, —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞).
      - 2025-09-27T20:35Z ‚Äî ‚ôªÔ∏è **Updated** `src/models/__init__.py`: —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω `ScheduleEntry` –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ –º–æ–¥–µ–ª–µ–π.
  - [x] ‚úÖ Sub-step 1.2: –û–±–Ω–æ–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π Airtable
    - **Directory**: `src/config/field_mappings/`
    - **Files to create/modify**: `src/config/field_mappings/schedule.py`, `src/config/__init__.py`
    - **Accept**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª–µ–π Airtable –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä–≤–∏—Å–æ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.
    - **Tests**: `tests/unit/test_config/test_field_mappings.py`
    - **Done**: ‚úÖ –ú–∞–ø–ø–∏–Ω–≥ —Å–æ–∑–¥–∞–Ω —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ field ID –∏ option ID –∏–∑ Airtable.
    - **Changelog**:
      - 2025-09-27T21:30Z ‚Äî ‚ú≥Ô∏è **Created** `src/config/field_mappings/schedule.py`: –ø–æ–ª–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π Schedule table —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ ID
      - 2025-09-27T21:30Z ‚Äî ‚ôªÔ∏è **Updated** `.env` –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º Table ID `tblsxihPaZebzyBS2`

- [ ] Step 2: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
  - [ ] Sub-step 2.1: –ù–∞–ø–∏—Å–∞—Ç—å Airtable —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π/—Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
    - **Directory**: `src/data/airtable/`
    - **Files to create/modify**: `src/data/airtable/airtable_schedule_repo.py`, `src/data/airtable/__init__.py`
    - **Accept**: –ú–µ—Ç–æ–¥ `fetch_schedule(date_from, date_to)` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ `ScheduleEntry`, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ `IsActive`, —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ –¥–∞—Ç–µ, `Order`, `StartTime`.
    - **Tests**: `tests/unit/test_data/test_airtable/test_airtable_schedule_repo.py`
    - **Done**: –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é, –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
    - **Changelog**: –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å AirTable –∑–∞–ø—Ä–æ—Å–æ–º.
  - [ ] Sub-step 2.2: –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
    - **Directory**: `src/services/`
    - **Files to create/modify**: `src/services/schedule_service.py`
    - **Accept**: –°–µ—Ä–≤–∏—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ –¥–∞—Ç–∞–º —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∫–µ—à–∞ (TTL ‚â§10 –º–∏–Ω) –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.
    - **Tests**: `tests/unit/test_services/test_schedule_service.py`
    - **Done**: –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–∏—Ä—É—é—Ç —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç, –∫–µ—à-—Ö–∏—Ç, –æ—à–∏–±–∫—É Airtable.
    - **Changelog**: –°–æ–∑–¥–∞–Ω —Å–µ—Ä–≤–∏—Å —Å in-memory –∫–µ—à–µ–º –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞.

- [ ] Step 3: –û–±–Ω–æ–≤–∏—Ç—å Telegram-–±–æ—Ç–∞
  - [ ] Sub-step 3.1: –î–æ–±–∞–≤–∏—Ç—å keyboards –∏ –Ω–æ–≤—ã–µ callback data
    - **Directory**: `src/bot/keyboards/`
    - **Files to create/modify**: `src/bot/keyboards/schedule.py`, `src/bot/keyboards/__init__.py`
    - **Accept**: Inline-–∫–Ω–æ–ø–∫–∏ –¥–ª—è 13‚Äì16 –Ω–æ—è–±—Ä—è + –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥", "–û–±–Ω–æ–≤–∏—Ç—å".
    - **Tests**: `tests/unit/test_bot_keyboards/test_schedule_keyboard.py`
    - **Done**: –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø–æ–¥–ø–∏—Å–∏ –∏ callback data.
    - **Changelog**: –î–æ–±–∞–≤–ª–µ–Ω—ã –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –∫–ª–∞–≤–∏–∞—Ç—É—Ä –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.
  - [ ] Sub-step 3.2: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ö–µ–Ω–¥–ª–µ—Ä—ã –∫–æ–º–∞–Ω–¥—ã `/schedule`
    - **Directory**: `src/bot/handlers/`
    - **Files to create/modify**: `src/bot/handlers/schedule_handlers.py`, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `src/bot/handlers/__init__.py`, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ `src/bot/handlers/search_conversation.py` –∏–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º router.
    - **Accept**: –ö–æ–º–∞–Ω–¥–∞ `/schedule` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≤—ã–±–æ—Ä–∞ –¥–Ω—è; –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –≤—ã–≤–æ–¥–∏—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–Ω—è –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏.
    - **Tests**: `tests/unit/test_bot_handlers/test_schedule_handlers.py`, `tests/integration/test_bot_handlers/test_schedule_flow.py`
    - **Done**: –Æ–Ω–∏—Ç –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, –±–æ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è.
    - **Changelog**: –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã –∏ –º–∞—Ä—à—Ä—É—Ç—ã.

- [ ] Step 4: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
  - [ ] Sub-step 4.1: –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
    - **Directory**: `src/utils/`
    - **Files to create/modify**: `src/utils/schedule_formatter.py`
    - **Accept**: –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç markdown-—Å—Ç—Ä–æ–∫—É —Å –¥–∞—Ç–æ–π, —ç–º–æ–¥–∑–∏ –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏.
    - **Tests**: `tests/unit/test_utils/test_schedule_formatter.py`
    - **Done**: –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫, —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏, –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–ª–∏–Ω–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π.
    - **Changelog**: –î–æ–±–∞–≤–ª–µ–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.
  - [ ] Sub-step 4.2: –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é/–∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
    - **Directory**: `src/config/`
    - **Files to create/modify**: `src/config/messages.py` (–∏–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª —Å–æ–æ–±—â–µ–Ω–∏–π)
    - **Accept**: –í—Å–µ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—Ç–∏–ª—é –ø—Ä–æ–µ–∫—Ç–∞.
    - **Tests**: `tests/unit/test_config/test_messages.py`
    - **Done**: –¢–µ—Å—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–π –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã.
    - **Changelog**: –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.

- [ ] Step 5: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–µ–ø–ª–æ—è
  - [ ] Sub-step 5.1: –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Airtable
    - **Directory**: `docs/data-integration/`
    - **Files to create/modify**: `docs/data-integration/airtable_database_structure.md`
    - **Accept**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, –ø–æ–ª—è, —Ç–∏–ø—ã, —Ñ–∏–ª—å—Ç—Ä—ã, –∫–µ—à TTL.
    - **Tests**: –ù/–î (—Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞).
    - **Done**: –î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —à–∞–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –∏ –≤—å—é.
    - **Changelog**: –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–≤–µ–¥–µ–Ω–∏—è –æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏.
  - [ ] Sub-step 5.2: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
    - **Directory**: `src/config/`, `docs/development/`
    - **Files to create/modify**: `.env.example`, `docs/development/setup_guide.md`
    - **Accept**: –£–∫–∞–∑–∞–Ω—ã –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É.
    - **Tests**: –ù/–î.
    - **Done**: –î–æ–∫—É–º–µ–Ω—Ç—ã –æ—Ç—Ä–∞–∂–∞—é—Ç –Ω–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
    - **Changelog**: –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ/–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

### Constraints
- –°–æ–±–ª—é–¥–∞—Ç—å –ª–∏–º–∏—Ç Airtable API (5 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫—É–Ω–¥–∞); –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 24-—á–∞—Å–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏ –∏ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å —Å–æ–±—ã—Ç–∏—è (—É—Ç–æ—á–Ω–∏—Ç—å: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–µ—Å—Ç–Ω–æ–µ –≤—Ä–µ–º—è —Ä–µ—Ç—Ä–∏—Ç–∞).
- Inline-–∫–Ω–æ–ø–∫–∏ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–º UX-–ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –±–æ—Ç–∞ –∏ –Ω–µ –Ω–∞—Ä—É—à–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏.

### GATE 4: Technical Plan Review (MANDATORY)
- **Action Required**: –ü–µ—Ä–µ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç –ü–ª–∞–Ω-—Ä–µ–≤—å—é–µ—Ä—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏.

### Task Splitting Evaluation
**Status**: Pending | **Evaluated by**: ‚Äî | **Date**: ‚Äî
**Decision**: TBD –ø–æ—Å–ª–µ —Ä–µ–≤—å—é.
**Reasoning**: –ë—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π.

## Notes for Other Devs (Optional)
- –¢—Ä–µ–±—É–µ—Ç—Å—è —É—Ç–æ—á–Ω–∏—Ç—å —É –≤–ª–∞–¥–µ–ª—å—Ü–∞ Airtable: –±—É–¥—É—Ç –ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–∂—É—Ä—Å—Ç–≤–∞ –ø–æ—Å–ª–µ 16.11 (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π future scope).
- –¶–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ–æ–Ω–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (cron/webhook), —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—Ç–≤–µ—Ç –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.
- –¢–µ—Å—Ç `test_schedule_refresh_background_job` –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å —Ñ–∏–∫—Å—Ç—É—Ä—É –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ (apscheduler/celery) ‚Äî —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –ø–æ–¥—Ö–æ–¥ –∑–∞—Ä–∞–Ω–µ–µ.

## Progress Log
- 2025-09-27T20:12:20Z ‚Äî Task setup approved, branch created, waiting on Linear issue ID before status sync.
- 2025-09-27T20:35:00Z ‚Äî –ù–∞—á–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Step 1.1: –∑–∞–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –º–æ–¥–µ–ª—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏ unit-—Ç–µ—Å—Ç—ã; –≤—ã—è–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ Pydantic –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ `ScheduleEntry`, —Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–ª–µ–π/–≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤.
- 2025-09-27T21:30:00Z ‚Äî ‚úÖ **Airtable Setup Complete**: Created Schedule table (`tblsxihPaZebzyBS2`) with 12 fields, updated field mappings with real IDs, added 111 real Tres Dias events covering Nov 13-16, 2025. Documentation updated in `airtable_database_structure.md` and setup guide created. Linear issue AGB-76 created. Ready for service layer implementation.
- 2025-09-27T21:50:00Z ‚Äî üîÑ **PR Opened/Updated**: PR #71 targeting this branch; CI re-run triggered. Implemented minimal constant-time mitigation in auth checks to stabilize security timing test in CI.
- 2025-09-27T22:05:00Z ‚Äî ‚úÖ **Implementation Complete**: All code changes pushed; local test suite green. Ready for code review.
